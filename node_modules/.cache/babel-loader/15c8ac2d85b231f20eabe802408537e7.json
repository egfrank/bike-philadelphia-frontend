{"ast":null,"code":"var _jsxFileName = \"/Users/elliotgoldingfrank/bikephil-frontend/bikephilreact/src/components/AutoComplete.js\";\nimport { connect } from 'react-redux';\nimport React from 'react';\nimport { debounce } from \"throttle-debounce\";\nconst ACCESS_TOKEN = 'pk.eyJ1IjoiZWxsaW90Z2ZyYW5rIiwiYSI6ImNqd3V4aXFzZTBkMjA0YW4xNGFwNnU4cWwifQ.BsUA_68pUHaCU7v4PCKLKw';\n\nfunction constructSearchUrl(searchTerm) {\n  let params = {\n    bbox: '-76,39,-75,41',\n    access_token: ACCESS_TOKEN\n  };\n  let esc = encodeURIComponent;\n  let url = 'https://api.mapbox.com/geocoding/v5/mapbox.places/';\n  url += \"\".concat(esc(searchTerm), \".json\");\n  let query = Object.keys(params).map(k => esc(k) + '=' + esc(params[k])).join('&');\n  url += '?';\n  url += query;\n  return url;\n}\n\nclass SearchResult extends React.Component {\n  constructor(props) {\n    super(props);\n    this.handleKeyStroke = this.handleKeyStroke.bind(this);\n  }\n\n  handleKeyStroke() {\n    this.props.handleKeyStroke;\n  }\n\n  render() {\n    const info = this.props.info;\n    const name = info.text;\n    const address = info.properties.address;\n    const coordinates = info.geometry.coordinates;\n    const style = {\n      'backgroundColor': this.props.active ? '#e9e9e9' : 'white'\n    };\n    return React.createElement(\"div\", {\n      style: style,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 43\n      },\n      __self: this\n    }, React.createElement(\"b\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 44\n      },\n      __self: this\n    }, name), \" \", address);\n  }\n\n}\n\nclass AutoComplete extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.onKeyDown = event => {\n      if (event.key === 'ArrowDown') {\n        this.incrementHover();\n      } else if (event.key === 'ArrowUp') {\n        this.decrementHover();\n      }\n    };\n\n    this.changeQuery = event => {\n      this.setState({\n        q: event.target.value\n      }, () => {\n        const q = this.state.q;\n        this.autocompleteSearchDebounced(this.state.q);\n      });\n    };\n\n    this.autocompleteSearch = q => {\n      this.storeSearch(q);\n      this.makeAutocompleteLookup(q);\n    };\n\n    this.makeAutocompleteLookup = q => {\n      // Store the latest input here scoped in the App instance.\n      this.waitingFor = q;\n      fetch(constructSearchUrl(q)).then(response => {\n        if (response.status === 200) {\n          // Only bother with this XHR response\n          // if this query term matches what we're waiting for.\n          if (q === this.waitingFor) {\n            response.json().then(results => {\n              this.setState({\n                searchResults: results.features\n              });\n            });\n          }\n        }\n      });\n    };\n\n    this.storeSearch = q => {\n      const _searches = this.state._searches || [];\n\n      _searches.push(q);\n\n      this.setState({\n        _searches\n      });\n    };\n\n    this.state = {\n      q: \"\",\n      searchResults: [],\n      hoverResult: 2\n    };\n    this.autocompleteSearchDebounced = debounce(500, this.autocompleteSearch);\n    this.incrementHover = this.incrementHover.bind(this);\n    this.decrementHover = this.decrementHover.bind(this);\n  }\n\n  incrementHover() {\n    let h = Math.min(this.state.hoverResult + 1, this.state.searchResults - 1);\n    this.setState({\n      hoverResult: h\n    });\n  }\n\n  decrementHover() {\n    let h = Math.max(this.state.hoverResult - 1, -1);\n    this.setState({\n      hoverResult: h\n    });\n  }\n\n  render() {\n    const _searches = this.state._searches || [];\n\n    const results = [];\n\n    for (let i = 0; i < this.state.searchResults.length; i++) {\n      let r = this.state.searchResults[i];\n      results.push(React.createElement(SearchResult, {\n        key: r.id,\n        info: r,\n        active: i === this.state.hoverResult,\n        onKeyDown: event => alert(event.key),\n        tabIndex: 0,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }));\n    }\n\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      placeholder: \"Type something here\",\n      type: \"text\",\n      value: this.state.q,\n      onChange: this.changeQuery,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140\n      },\n      __self: this\n    }), results, React.createElement(\"hr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148\n      },\n      __self: this\n    }), _searches.length ? React.createElement(\"button\", {\n      type: \"button\",\n      onClick: event => this.setState({\n        _searches: []\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150\n      },\n      __self: this\n    }, \"Reset\") : null, React.createElement(\"ol\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157\n      },\n      __self: this\n    }, _searches.map((s, i) => {\n      return React.createElement(\"li\", {\n        key: s + i,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159\n        },\n        __self: this\n      }, s);\n    })));\n  }\n\n}\n\nexport default AutoComplete;","map":{"version":3,"sources":["/Users/elliotgoldingfrank/bikephil-frontend/bikephilreact/src/components/AutoComplete.js"],"names":["connect","React","debounce","ACCESS_TOKEN","constructSearchUrl","searchTerm","params","bbox","access_token","esc","encodeURIComponent","url","query","Object","keys","map","k","join","SearchResult","Component","constructor","props","handleKeyStroke","bind","render","info","name","text","address","properties","coordinates","geometry","style","active","AutoComplete","onKeyDown","event","key","incrementHover","decrementHover","changeQuery","setState","q","target","value","state","autocompleteSearchDebounced","autocompleteSearch","storeSearch","makeAutocompleteLookup","waitingFor","fetch","then","response","status","json","results","searchResults","features","_searches","push","hoverResult","h","Math","min","max","i","length","r","id","alert","s"],"mappings":"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","sourcesContent":["import { connect } from 'react-redux'\nimport React from 'react';\nimport { debounce } from \"throttle-debounce\";\n\nconst ACCESS_TOKEN = 'pk.eyJ1IjoiZWxsaW90Z2ZyYW5rIiwiYSI6ImNqd3V4aXFzZTBkMjA0YW4xNGFwNnU4cWwifQ.BsUA_68pUHaCU7v4PCKLKw'\n\nfunction constructSearchUrl(searchTerm){\n\tlet params = {\n\t\tbbox: '-76,39,-75,41',\n\t\taccess_token: ACCESS_TOKEN\n\t}\n\tlet esc = encodeURIComponent;\n\tlet url = 'https://api.mapbox.com/geocoding/v5/mapbox.places/';\n\turl += `${esc(searchTerm)}.json`;\n\tlet query = Object.keys(params)\n\t\t.map(k => esc(k) + '=' + esc(params[k]))\n\t\t.join('&');\n\turl += '?'\n\turl += query;\n\n\treturn url\n}\n\n\n\nclass SearchResult extends React.Component{\n  constructor(props){\n    super(props);\n    this.handleKeyStroke = this.handleKeyStroke.bind(this)\n  }\n\n  handleKeyStroke(){\n    this.props.handleKeyStroke;\n  }\n\n  render(){\n    const info = this.props.info\n    const name = info.text\n    const address = info.properties.address\n    const coordinates = info.geometry.coordinates\n    const style = {'backgroundColor': this.props.active ? '#e9e9e9' : 'white'}\n    return (\n      <div style={style}>\n        <b>{name}</b> {address}\n      </div>\n    )\n  }\n}\n\nclass AutoComplete extends React.Component{\n  constructor(props) {\n    super(props);\n    this.state = {\n    \t q: \"\", \n    \t searchResults: [],\n       hoverResult: 2,\n\t};\n    this.autocompleteSearchDebounced = debounce(500, this.autocompleteSearch);\n    this.incrementHover = this.incrementHover.bind(this)\n    this.decrementHover = this.decrementHover.bind(this)\n  }\n\n  onKeyDown = event => {\n    if (event.key === 'ArrowDown'){\n      this.incrementHover()\n    } else if (event.key === 'ArrowUp'){\n      this.decrementHover()\n    }\n\n  }\n\n  incrementHover(){ \n    let h = Math.min(this.state.hoverResult+1, this.state.searchResults-1)\n    this.setState({hoverResult: h})\n  }\n\n  decrementHover(){ \n    let h = Math.max(this.state.hoverResult-1, -1)\n    this.setState({hoverResult: h})\n  }\n\n  changeQuery = event => {\n    this.setState({ q: event.target.value }, () => {\n      const q = this.state.q;\n      this.autocompleteSearchDebounced(this.state.q);\n      \n    });\n  };\n\n  autocompleteSearch = q => {\n    this.storeSearch(q);\n    this.makeAutocompleteLookup(q);\n  };\n\n  makeAutocompleteLookup = q => {\n    // Store the latest input here scoped in the App instance.\n    this.waitingFor = q;\n    fetch(constructSearchUrl(q))\n    .then(response => {\n      if (response.status === 200) {\n        // Only bother with this XHR response\n        // if this query term matches what we're waiting for.\n        if (q === this.waitingFor) {\n          response.json()\n          .then(results => {\n              this.setState({searchResults: results.features});\n          })\n        }\n      }\n    })\n  }\n\n\n\n  storeSearch = q => {\n    const _searches = this.state._searches || [];\n    _searches.push(q);\n    this.setState({ _searches });\n  }\n\n\n  render() {\n    const _searches = this.state._searches || [];\n    const results = [];\n    for (let i=0; i<this.state.searchResults.length; i++){\n      let r = this.state.searchResults[i];\n      results.push(\n          <SearchResult \n            key={r.id}\n            info={r}\n            active={i === this.state.hoverResult}\n            onKeyDown={event => alert(event.key)}\n            tabIndex={0}\n          />\n      )\n    }\n    return (\n      <div>\n\n        <input\n          placeholder=\"Type something here\"\n          type=\"text\"\n          value={this.state.q}\n          onChange={this.changeQuery}\n        />\n        {results}\n\n        <hr />\n        {_searches.length ? (\n          <button\n            type=\"button\"\n            onClick={event => this.setState({ _searches: [] })}\n          >\n            Reset\n          </button>\n        ) : null}\n        <ol>\n          {_searches.map((s, i) => {\n            return <li key={s + i}>{s}</li>;\n          })}\n        </ol>\n      </div>\n    );\n  }\n}\n\n\nexport default AutoComplete;\n"]},"metadata":{},"sourceType":"module"}