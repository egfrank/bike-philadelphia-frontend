{"ast":null,"code":"import _slicedToArray from \"/Users/elliotgoldingfrank/bikephil-frontend/bikephilreact/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/elliotgoldingfrank/bikephil-frontend/bikephilreact/src/components/SearchBar.js\";\nimport { connect } from 'react-redux';\nimport React from 'react';\nimport { debounce } from \"throttle-debounce\";\nimport { fetchDistanceMatrix } from '../actions';\nconst ACCESS_TOKEN = 'pk.eyJ1IjoiZWxsaW90Z2ZyYW5rIiwiYSI6ImNqd3V4aXFzZTBkMjA0YW4xNGFwNnU4cWwifQ.BsUA_68pUHaCU7v4PCKLKw';\n\nfunction constructSearchUrl(searchTerm) {\n  let params = {\n    bbox: '-76,39,-75,41',\n    access_token: ACCESS_TOKEN\n  };\n  let esc = encodeURIComponent;\n  let url = 'https://api.mapbox.com/geocoding/v5/mapbox.places/';\n  url += \"\".concat(esc(searchTerm), \".json\");\n  let query = Object.keys(params).map(k => esc(k) + '=' + esc(params[k])).join('&');\n  url += '?';\n  url += query;\n  return url;\n}\n\nclass AutoComplete extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.submitResult = index => {\n      let location = this.state.searchResults[index];\n      console.log(location.geometry.coordinates);\n\n      let _location$geometry$co = location.geometry.coordinates.map(x => +x),\n          _location$geometry$co2 = _slicedToArray(_location$geometry$co, 2),\n          long = _location$geometry$co2[0],\n          lat = _location$geometry$co2[1]; // Why tf is it like this\n\n\n      this.props.searchForDistanceMatrix([lat, long]);\n    };\n\n    this.handleEnter = () => {\n      if (this.state.hoverResult > -1 && this.state.hoverResult < this.state.searchResults.length) {\n        this.submitResult(this.state.hoverResult);\n      }\n    };\n\n    this.clickResult = index => {\n      this.submitResult(index);\n    };\n\n    this.changeQuery = event => {\n      this.setState({\n        q: event.target.value\n      }, () => {\n        this.autocompleteSearchDebounced(this.state.q);\n      });\n    };\n\n    this.autocompleteSearch = q => {\n      this.storeSearch(q);\n      this.makeAutocompleteLookup(q);\n    };\n\n    this.makeAutocompleteLookup = q => {\n      // Store the latest input here scoped in the App instance.\n      this.waitingFor = q;\n      fetch(constructSearchUrl(q)).then(response => {\n        if (response.status === 200) {\n          // Only bother with this XHR response\n          // if this query term matches what we're waiting for.\n          if (q === this.waitingFor) {\n            response.json().then(results => {\n              this.setState({\n                searchResults: results.features\n              });\n            });\n          }\n        }\n      });\n    };\n\n    this.storeSearch = q => {\n      const _searches = this.state._searches || [];\n\n      _searches.push(q);\n\n      this.setState({\n        _searches\n      });\n    };\n\n    this.state = {\n      q: \"\",\n      searchResults: [],\n      hoverResult: -1\n    };\n    this.autocompleteSearchDebounced = debounce(500, this.autocompleteSearch);\n    this.incrementHover = this.incrementHover.bind(this);\n    this.decrementHover = this.decrementHover.bind(this);\n    this.handleKeyStroke = this.handleKeyStroke.bind(this);\n  }\n\n  handleKeyStroke(event) {\n    if (event.key === 'ArrowDown') {\n      event.preventDefault();\n      this.incrementHover();\n    } else if (event.key === 'ArrowUp') {\n      event.preventDefault();\n      this.decrementHover();\n    } else if (event.key === 'Enter') {\n      event.preventDefault();\n      this.handleEnter();\n    }\n  }\n\n  incrementHover() {\n    let h = Math.min(this.state.hoverResult + 1, this.state.searchResults.length);\n    this.setState({\n      hoverResult: h\n    });\n  }\n\n  decrementHover() {\n    let h = Math.max(this.state.hoverResult - 1, -1);\n    this.setState({\n      hoverResult: this.state.hoverResult - 1\n    });\n  }\n\n  render() {\n    const DIV_STYLE = {\n      width: '500px'\n    };\n    const INPUT_STYLE = {\n      width: '100%',\n      fontSize: 16,\n      padding: 4,\n      boxSizing: 'border-box',\n      border: '1px solid grey',\n      borderRadius: 10\n    };\n\n    const _searches = this.state._searches || [];\n\n    const results = [];\n\n    for (let i = 0; i < this.state.searchResults.length; i++) {\n      let r = this.state.searchResults[i];\n      results.push(React.createElement(SearchResult, {\n        key: r.id,\n        info: r,\n        active: i === this.state.hoverResult,\n        index: i,\n        clickResult: this.clickResult,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      }));\n    }\n\n    return React.createElement(\"div\", {\n      style: DIV_STYLE,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      placeholder: \"Type something here\",\n      type: \"text\",\n      value: this.state.q,\n      onChange: this.changeQuery,\n      onKeyDown: event => this.handleKeyStroke(event),\n      style: INPUT_STYLE,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153\n      },\n      __self: this\n    }), results, React.createElement(\"hr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163\n      },\n      __self: this\n    }));\n  }\n\n}\n\nclass SearchResult extends React.Component {\n  constructor(props) {\n    super(props);\n    this.handleClick = this.handleClick.bind(this);\n  }\n\n  handleClick() {\n    this.props.clickResult(this.props.index);\n  }\n\n  render() {\n    const info = this.props.info;\n    const name = info.text;\n    const address = info.properties.address;\n    const coordinates = info.geometry.coordinates;\n    const style = {\n      backgroundColor: this.props.active ? '#e9e9e9' : 'white',\n      fontSize: 16,\n      padding: 4\n    };\n    return React.createElement(\"div\", {\n      style: style,\n      onClick: () => this.handleClick(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191\n      },\n      __self: this\n    }, React.createElement(\"b\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192\n      },\n      __self: this\n    }, name), \" \", address);\n  }\n\n}\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    searchForDistanceMatrix: coordinatesToLookUp => {\n      dispatch(fetchDistanceMatrix(coordinatesToLookUp));\n    }\n  };\n};\n\nconst SearchBar = connect(null, mapDispatchToProps)(AutoComplete);\nexport default SearchBar;","map":{"version":3,"sources":["/Users/elliotgoldingfrank/bikephil-frontend/bikephilreact/src/components/SearchBar.js"],"names":["connect","React","debounce","fetchDistanceMatrix","ACCESS_TOKEN","constructSearchUrl","searchTerm","params","bbox","access_token","esc","encodeURIComponent","url","query","Object","keys","map","k","join","AutoComplete","Component","constructor","props","submitResult","index","location","state","searchResults","console","log","geometry","coordinates","x","long","lat","searchForDistanceMatrix","handleEnter","hoverResult","length","clickResult","changeQuery","event","setState","q","target","value","autocompleteSearchDebounced","autocompleteSearch","storeSearch","makeAutocompleteLookup","waitingFor","fetch","then","response","status","json","results","features","_searches","push","incrementHover","bind","decrementHover","handleKeyStroke","key","preventDefault","h","Math","min","max","render","DIV_STYLE","width","INPUT_STYLE","fontSize","padding","boxSizing","border","borderRadius","i","r","id","SearchResult","handleClick","info","name","text","address","properties","style","backgroundColor","active","mapDispatchToProps","dispatch","coordinatesToLookUp","SearchBar"],"mappings":"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","sourcesContent":["import { connect } from 'react-redux'\nimport React from 'react';\nimport { debounce } from \"throttle-debounce\";\nimport { fetchDistanceMatrix } from '../actions'\n\nconst ACCESS_TOKEN = 'pk.eyJ1IjoiZWxsaW90Z2ZyYW5rIiwiYSI6ImNqd3V4aXFzZTBkMjA0YW4xNGFwNnU4cWwifQ.BsUA_68pUHaCU7v4PCKLKw'\n\nfunction constructSearchUrl(searchTerm){\n\tlet params = {\n\t\tbbox: '-76,39,-75,41',\n\t\taccess_token: ACCESS_TOKEN\n\t}\n\tlet esc = encodeURIComponent;\n\tlet url = 'https://api.mapbox.com/geocoding/v5/mapbox.places/';\n\turl += `${esc(searchTerm)}.json`;\n\tlet query = Object.keys(params)\n\t\t.map(k => esc(k) + '=' + esc(params[k]))\n\t\t.join('&');\n\turl += '?'\n\turl += query;\n\n\treturn url\n}\n\n\nclass AutoComplete extends React.Component{\n  constructor(props) {\n    super(props);\n    this.state = {\n    \t q: \"\", \n    \t searchResults: [],\n       hoverResult: -1,\n\t};\n    this.autocompleteSearchDebounced = debounce(500, this.autocompleteSearch);\n    this.incrementHover = this.incrementHover.bind(this)\n    this.decrementHover = this.decrementHover.bind(this)\n    this.handleKeyStroke = this.handleKeyStroke.bind(this)\n  }\n\n  handleKeyStroke(event){\n    if (event.key === 'ArrowDown'){\n      event.preventDefault()\n      this.incrementHover()\n    } else if (event.key === 'ArrowUp'){\n      event.preventDefault()\n      this.decrementHover()\n    } else if (event.key === 'Enter'){\n      event.preventDefault()\n      this.handleEnter()\n    }\n  }\n\n  submitResult = index => {\n    let location = this.state.searchResults[index]\n    console.log(location.geometry.coordinates)\n    let [long, lat] = location.geometry.coordinates.map(x => +x)\n    // Why tf is it like this\n    this.props.searchForDistanceMatrix([lat, long])\n  }\n\n  handleEnter = () => {\n    if ( this.state.hoverResult > -1 && this.state.hoverResult < this.state.searchResults.length){\n      this.submitResult(this.state.hoverResult)\n    }\n  }\n\n  clickResult = index => {\n    this.submitResult(index)\n  }\n\n  incrementHover(){ \n    let h = Math.min(this.state.hoverResult+1, this.state.searchResults.length)\n    this.setState({hoverResult: h})\n  }\n\n  decrementHover(){ \n    let h = Math.max(this.state.hoverResult-1, -1)\n    this.setState({hoverResult: this.state.hoverResult-1})\n  }\n\n  changeQuery = event => {\n    this.setState({ q: event.target.value }, () => {\n      this.autocompleteSearchDebounced(this.state.q);\n    });\n  };\n\n  autocompleteSearch = q => {\n    this.storeSearch(q);\n    this.makeAutocompleteLookup(q);\n  };\n\n  makeAutocompleteLookup = q => {\n    // Store the latest input here scoped in the App instance.\n    this.waitingFor = q;\n    fetch(constructSearchUrl(q))\n    .then(response => {\n      if (response.status === 200) {\n        // Only bother with this XHR response\n        // if this query term matches what we're waiting for.\n        if (q === this.waitingFor) {\n          response.json()\n          .then(results => {\n              this.setState({searchResults: results.features});\n          })\n        }\n      }\n    })\n  }\n\n\n\n  storeSearch = q => {\n    const _searches = this.state._searches || [];\n    _searches.push(q);\n    this.setState({ _searches });\n  }\n\n\n  render() {\n\n    const DIV_STYLE = {\n      width: '500px',\n    }\n    \n   \n    const INPUT_STYLE = {\n      width: '100%',\n      fontSize: 16,\n      padding: 4,\n      boxSizing: 'border-box',\n      border: '1px solid grey',\n      borderRadius: 10,\n      \n\n    }\n\n    const _searches = this.state._searches || [];\n    const results = [];\n    for (let i=0; i<this.state.searchResults.length; i++){\n      let r = this.state.searchResults[i];\n      results.push(\n          <SearchResult \n            key={r.id}\n            info={r}\n            active={i === this.state.hoverResult}\n            index={i}\n            clickResult={this.clickResult}\n          />\n      )\n    }\n    return (\n      <div style={DIV_STYLE}>\n        <input\n          placeholder=\"Type something here\"\n          type=\"text\"\n          value={this.state.q}\n          onChange={this.changeQuery}\n          onKeyDown={event => this.handleKeyStroke(event)}\n          style={INPUT_STYLE}\n        />\n        {results}\n\n        <hr />\n      </div>\n    );\n  }\n}\n\nclass SearchResult extends React.Component{\n  constructor(props){\n    super(props);\n    this.handleClick = this.handleClick.bind(this);\n  }\n\n  handleClick(){\n    this.props.clickResult(this.props.index)\n  }\n\n  render(){\n    const info = this.props.info\n    const name = info.text\n    const address = info.properties.address\n    const coordinates = info.geometry.coordinates\n    const style = {\n      backgroundColor: this.props.active ? '#e9e9e9' : 'white',\n      fontSize: 16,\n      padding: 4\n\n    }\n    return (\n      <div style={style} onClick={() => this.handleClick()}>\n        <b>{name}</b> {address}\n      </div>\n    )\n  }\n}\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    searchForDistanceMatrix: (coordinatesToLookUp) => {\n        dispatch(fetchDistanceMatrix(coordinatesToLookUp))\n    }\n  }\n};\n \n\nconst SearchBar = connect(null, mapDispatchToProps)(AutoComplete);\n\n\nexport default SearchBar;\n"]},"metadata":{},"sourceType":"module"}